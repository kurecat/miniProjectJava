<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>main</title>

    <link rel="stylesheet" th:href="@{/css/swiper-bundle.min.css}" />

    <link rel="stylesheet" th:href="@{/css/style.css}" />
  </head>
  <body>
    <div class="container">
      <div th:replace="~{fragments/header :: header}"></div>
      <main class="main-content">
        <div class="swiper mySwiper">
          <div class="swiper-wrapper">
            <div class="swiper-slide video-slide">
              <div id="player1" class="youtube-player-background"></div>
              <div class="slide-content">
                <h1>ìì·¨ì˜ êµê³¼ì„œ ê°™ì€ ì§‘</h1>
                <p>ì‹ ë¦¼ 4í‰ ì›ë£¸ ì›”ì„¸</p>
                <button class="slide-btn">ìì„¸íˆ ë³´ê¸° &gt;</button>
              </div>
            </div>

            <div class="swiper-slide video-slide">
              <div id="player2" class="youtube-player-background"></div>
              <div class="slide-content">
                <h1>ìì·¨ìš”ë¦¬ ì „ë¬¸ê°€ì˜ ì§‘</h1>
                <p>"ì§‘ì—ì„œ 3ë¼ ë‹¤ í•´ë¨¹ì–´ìš”"</p>
                <button class="slide-btn">ìì„¸íˆ ë³´ê¸° &gt;</button>
              </div>
            </div>

            <div class="swiper-slide video-slide">
              <div id="player3" class="youtube-player-background"></div>
              <div class="slide-content">
                <h1>ê³ ë¬¼ê°€ ì‹œëŒ€ì—ì„œ ì‚´ì•„ë‚¨ê¸°</h1>
                <p>-ìì·¨ì¿ íŒ¡ í•„ìˆ˜í…œí¸-</p>
                <a
                  href="https://www.youtube.com/watch?v=zzBu5eSM7bU&t"
                  target="_blank"
                  ><button class="slide-btn">ìì„¸íˆ ë³´ê¸° &gt;</button></a
                >
              </div>
            </div>
            <div class="swiper-slide">
              <img
                src="https://via.placeholder.com/1140x400/2ecc71/ffffff?text=Slide+3"
                alt="Slide 3"
              />
            </div>
          </div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-pagination"></div>
        </div>
        <div class="postlist">
          <button>ì „ì²´</button>
          <button>ê¿€íŒ</button>
          <button>ì§ˆë¬¸</button>
          <button>í›„ê¸°</button>
          <button>ì¡ë‹´</button>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">ë²ˆí˜¸</p>
            <p class="titlebox">ì œëª©</p>
            <p class="writer">ê¸€ì“´ì´</p>
            <p class="regdate">ë“±ë¡ì¼</p>
            <p class="views">ì¡°íšŒ</p>
            <p class="suggest">ì¶”ì²œ</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">1</p>
            <p class="titlebox">ã…ã„´ã…‡</p>
            <p class="writer">ã…ã„´ã…‡</p>
            <p class="regdate">25-11-12</p>
            <p class="views">0</p>
            <p class="suggest">0</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">2</p>
            <p class="titlebox">ã…ã„´ã…‡</p>
            <p class="writer">ã…ã„´ã…‡</p>
            <p class="regdate">25-11-12</p>
            <p class="views">0</p>
            <p class="suggest">0</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">3</p>
            <p class="titlebox">ã…ã„´ã…‡</p>
            <p class="writer">ã…ã„´ã…‡</p>
            <p class="regdate">25-11-12</p>
            <p class="views">0</p>
            <p class="suggest">0</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="ntwrvsbox">
            <p class="numberbox">0</p>
            <p class="titlebox">test</p>
            <p class="writer">test</p>
            <p class="regdate">25-11-12</p>
            <p class="views">test</p>
            <p class="suggest">test</p>
          </div>
          <hr />
          <!-- postlist -->
          <div class="postlistnumber">
            <p>ã€Šã€ˆ 1 2 3 4 5 6 7 8 9 10 ã€‰ã€‹</p>
          </div>
        </div>
        <div class="postlistright"></div>
        <div class="bastpostlist"></div>
        <div class="goodpostlist"></div>
      </main>
      <div th:replace="~{fragments/footer :: footer}"></div>
    </div>

    <script th:src="@{/js/swiper-bundle.min.js}"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
      // ëª¨ë“  YouTube í”Œë ˆì´ì–´ë¥¼ ê´€ë¦¬í•  ê°ì²´
      var players = {};
      // Swiper ì¸ìŠ¤í„´ìŠ¤
      var mySwiper;

      // 1. YouTube APIê°€ ì¤€ë¹„ë˜ë©´ ìë™ìœ¼ë¡œ í˜¸ì¶œë¨
      function onYouTubeIframeAPIReady() {
        // --- 1ë²ˆ ì˜ìƒ (player1) ìƒì„± ---
        players["player1"] = new YT.Player("player1", {
          /* ğŸ‘‡ğŸ‘‡ğŸ‘‡ 1ë²ˆ ì˜ìƒ ID (ì˜ˆ: 'S-N4a1A-TqE') ğŸ‘‡ğŸ‘‡ğŸ‘‡
           */
          videoId: "oMeYMLRwKrY",
          playerVars: {
            autoplay: 1,
            mute: 1,
            controls: 0,
            loop: 1,
            playlist: "oMeYMLRwKrY", // 1ë²ˆ ì˜ìƒ IDì™€ ë™ì¼í•˜ê²Œ
            modestbranding: 1,
            showinfo: 0,
            rel: 0,
          },
          events: {
            // 1ë²ˆ í”Œë ˆì´ì–´ê°€ ì¤€ë¹„ë˜ë©´ 'onPlayerReady' í•¨ìˆ˜ í˜¸ì¶œ
            onReady: onPlayerReady,
          },
        });

        // --- 2ë²ˆ ì˜ìƒ (player2) ìƒì„± ---
        players["player2"] = new YT.Player("player2", {
          videoId: "XJ8b9sWVFb0",
          playerVars: {
            autoplay: 1,
            mute: 1,
            controls: 0,
            loop: 1,
            playlist: "XJ8b9sWVFb0", // 2ë²ˆ ì˜ìƒ IDì™€ ë™ì¼í•˜ê²Œ
            modestbranding: 1,
            showinfo: 0,
            rel: 0,
          },
          events: {
            // 2ë²ˆ í”Œë ˆì´ì–´ê°€ ì¤€ë¹„ë˜ë©´ 'onPlayerReady' í•¨ìˆ˜ í˜¸ì¶œ
            onReady: onPlayerReady,
          },
        });

        // (ì˜ìƒì´ 3ê°œë¼ë©´ ì—¬ê¸°ì— players['player3'] = new YT.Player(...) ì¶”ê°€)
        players["player3"] = new YT.Player("player3", {
          videoId: "zzBu5eSM7bU",
          playerVars: {
            autoplay: 1,
            mute: 1,
            controls: 0,
            loop: 1,
            playlist: "zzBu5eSM7bU", // 2ë²ˆ ì˜ìƒ IDì™€ ë™ì¼í•˜ê²Œ
            modestbranding: 1,
            showinfo: 0,
            rel: 0,
          },
          events: {
            // 2ë²ˆ í”Œë ˆì´ì–´ê°€ ì¤€ë¹„ë˜ë©´ 'onPlayerReady' í•¨ìˆ˜ í˜¸ì¶œ
            onReady: onPlayerReady,
          },
        });
      }

      // 2. í”Œë ˆì´ì–´ ì¤€ë¹„ ìƒíƒœ í™•ì¸ ë° Swiper ì´ˆê¸°í™”

      // (ìˆ˜ì •) ì¤€ë¹„ëœ í”Œë ˆì´ì–´ ìˆ˜ë¥¼ ì²´í¬í•˜ê¸° ìœ„í•œ ë³€ìˆ˜
      var playersReadyCount = 0;
      var totalPlayers = 3; // (ì¤‘ìš”) ìƒì„±í•  ì´ í”Œë ˆì´ì–´ ìˆ˜ (ì§€ê¸ˆì€ 2ê°œ)

      function onPlayerReady(event) {
        // (ìˆ˜ì •) ëª¨ë“  í”Œë ˆì´ì–´ê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ì¹´ìš´íŠ¸ ì¦ê°€
        playersReadyCount++;

        // (ì¤‘ìš”) ëª¨ë“  í”Œë ˆì´ì–´ê°€ ì¤€ë¹„ë˜ì—ˆì„ ë•Œë§Œ Swiperë¥¼ 1ë²ˆ ì´ˆê¸°í™”
        if (playersReadyCount === totalPlayers) {
          initializeSwiper();
        }
      }

      // 3. Swiper ì´ˆê¸°í™” ë° ìŠ¬ë¼ì´ë“œ ì œì–´ í•¨ìˆ˜
      function initializeSwiper() {
        if (mySwiper) return; // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€

        mySwiper = new Swiper(".mySwiper", {
          navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
          },
          pagination: {
            el: ".swiper-pagination",
            clickable: true,
          },
          loop: true,

          on: {
            // (ì¤‘ìš”) ìŠ¬ë¼ì´ë“œê°€ ë°”ë€” ë•Œë§ˆë‹¤ ì‹¤í–‰
            slideChange: function () {
              var currentSlide = this.slides[this.activeIndex];

              // í˜„ì¬ í™œì„±í™”ëœ ìŠ¬ë¼ì´ë“œì— ìˆëŠ” í”Œë ˆì´ì–´ ID ì°¾ê¸°
              var activePlayerId = null;
              if (currentSlide.querySelector(".youtube-player-background")) {
                activePlayerId = currentSlide.querySelector(
                  ".youtube-player-background"
                ).id; // ì˜ˆ: "player1"
              }

              // ëª¨ë“  í”Œë ˆì´ì–´ë¥¼ ìˆœíšŒ
              for (var playerId in players) {
                if (players.hasOwnProperty(playerId)) {
                  var player = players[playerId];

                  // í˜„ì¬ í™œì„±í™”ëœ ìŠ¬ë¼ì´ë“œì˜ í”Œë ˆì´ì–´ë¼ë©´ -> ì¬ìƒ
                  if (playerId === activePlayerId) {
                    player.playVideo();
                  }
                  // í™œì„±í™”ë˜ì§€ ì•Šì€ (ë‹¤ë¥¸ ìŠ¬ë¼ì´ë“œì˜) í”Œë ˆì´ì–´ë¼ë©´ -> ì •ì§€
                  else {
                    player.pauseVideo();
                  }
                }
              }
            },

            // (ì¶”ê°€) Swiperê°€ ì²˜ìŒ ì´ˆê¸°í™”ë  ë•Œ ì‹¤í–‰
            init: function () {
              // 1ë²ˆ ìŠ¬ë¼ì´ë“œ(ì²« í™”ë©´)ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì˜ìƒ í”Œë ˆì´ì–´ë“¤ì€ ëª¨ë‘ ì •ì§€ì‹œí‚´
              // (loop ëª¨ë“œì—ì„œëŠ” ì²« ìŠ¬ë¼ì´ë“œê°€ 0ë²ˆì´ ì•„ë‹ ìˆ˜ ìˆìœ¼ë¯€ë¡œ
              //  slideChange ì´ë²¤íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ í•œë²ˆ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ë” ì•ˆì „í•¨)
              this.emit("slideChange"); // slideChange ì´ë²¤íŠ¸ë¥¼ ê°•ì œë¡œ ì‹¤í–‰
            },
          },
        });
      }
    </script>
  </body>
</html>
